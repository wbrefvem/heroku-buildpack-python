#!/usr/bin/env python

import yaml
import subprocess
import shlex
import os

if os.path.isfile('.travis.yml'):
    print '-----> Opening .travis.yml...'

    with open('.travis.yml', 'r') as stream:
        travis_yml = yaml.load(stream)
        before_install = travis_yml['before_install']

        if type(before_install) is list:
            print '    -----> Running through command list...'
            for command in before_install:
                subprocess.call(shlex.split(command))

        elif type(before_install) is str:
            print '    -----> Running single command...'
            subprocess.call(shlex.split(before_install))

subprocess.call(['./manage.py', 'migrate'])
subprocess.call(['./manage.py', 'loaddata', 'status'])
